{% extends "base1.html" %}

{% block title %}Payment | SMARTCART{% endblock %}

{% block content %}

<div class="center-box">
    <div class="card">

        <h2 style="text-align:center; margin-bottom:20px;">
            Complete Your Payment
        </h2>

        <p style="font-size:18px; text-align:center; margin-bottom:25px;">
            Total Amount: <strong>â‚¹{{ amount }}</strong>
        </p>
        <!-- <a href="{{ url_for('payment') }}" class="btn btn-primary">Pay Now</a>  -->

        <center> <button id="rzp-button" class="btn btn-primary">
                Pay now
            </button> </center>




    </div>
</div>


<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script>
    var options = {
        "key": "{{ key_id }}",
        "amount": "{{ amount * 100 }}",
        "currency": "INR",
        "name": "SmartCart",
        "description": "Order Payment",
        "order_id": "{{ order_id }}",
        "handler": function (response) {
            // Build a small form and POST to server for verification
            var form = document.createElement("form");
            form.method = "POST";
            form.action = "/verify-payment";

            var fields = {
                razorpay_payment_id: response.razorpay_payment_id,
                razorpay_order_id: response.razorpay_order_id,
                razorpay_signature: response.razorpay_signature
            };

            for (var name in fields) {
                var input = document.createElement("input");
                input.type = "hidden";
                input.name = name;
                input.value = fields[name];
                form.appendChild(input);
            }

            document.body.appendChild(form);
            form.submit();
        },
        "prefill": {
            // optionally prefill user info
        }
    };

    var rzp = new Razorpay(options);
    document.getElementById('rzp-button').onclick = function (e) {
        rzp.open();
        e.preventDefault();
    }
</script>


{% endblock %}